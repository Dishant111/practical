import{a as C,b as D,c as L,d as te}from"./chunk-2IWKX5KY.js";import{C as _,D as p,E as c,F as H,G as I,H as G,J as l,K as x,L as Q,N as q,P as R,Q as P,R as O,_ as F,c as w,f as v,ga as A,h as N,i as V,ia as j,j as y,ja as S,k as u,ka as $,l as g,la as z,ma as B,na as f,oa as U,p as a,pa as J,q as k,qa as K,ra as W,sa as X,t as b,ta as Y,u as m,ua as Z,v as M,va as ee,w as E,x as r,y as s,z as T}from"./chunk-NF5X2F4B.js";var se=["resolvModel"];function le(n,o){if(n&1){let e=_();r(0,"button",10),p("click",function(){u(e);let i=c().$implicit,d=c();return g(d.setTokenToPending(i.id))}),l(1," Change to pending "),s()}}function ae(n,o){if(n&1){let e=_();r(0,"button",10),p("click",function(){u(e);let i=c().$implicit,d=c();return g(d.setTokenToProcess(i.id))}),l(1," Change to Processing "),s()}}function de(n,o){if(n&1){let e=_();r(0,"tr")(1,"th",7),l(2),s(),r(3,"td"),l(4),s(),r(5,"td"),l(6),s(),r(7,"td"),b(8,le,2,0,"button",8)(9,ae,2,0,"button",8),r(10,"button",9),p("click",function(){let d=u(e).$implicit,h=c();return g(h.resolveToken(d.id))}),l(11," Resolve "),s()()()}if(n&2){let e=o.$implicit,t=c();E(t.getStatusclass(e.status)),a(2),x(e.id),a(2),x(t.getQueryName(e.query)),a(2),x(t.getStatusName(e.status)),a(2),m("ngIf",e.status==3||e.status==2),a(),m("ngIf",e.status==1)}}function me(n,o){n&1&&(r(0,"div",15)(1,"div",16)(2,"div",17)(3,"span",18),l(4,"Loading..."),s()()()())}function ce(n,o){if(n&1&&(r(0,"option",30),l(1),s()),n&2){let e=o.$implicit;m("ngValue",e.key),a(),Q(" ",e.value," ")}}function pe(n,o){if(n&1){let e=_();r(0,"div",15)(1,"form",19),p("ngSubmit",function(){u(e);let i=c(2);return g(i.submitTokenModel())}),r(2,"div",20)(3,"label",21),l(4,"Query Status"),s(),r(5,"select",22),b(6,ce,2,2,"option",23),s()(),r(7,"div",20)(8,"label",24),l(9,"Address"),s(),T(10,"input",25),s(),r(11,"div",20)(12,"label",24),l(13,"Phone number"),s(),T(14,"input",26),s(),r(15,"div",27)(16,"button",28),l(17," Resolve "),s(),r(18,"button",29),p("click",function(){u(e);let i=c().$implicit;return g(i.close("Close click"))}),l(19," Close "),s()()()()}if(n&2){let e=c(2);a(),m("formGroup",e.tokenModelForm),a(4),m("disabled",!0),a(),m("ngForOf",e.getAllQueryName()),a(4),M("is-valid",!e.tokenModelForm.controls.address.invalid&&(e.tokenModelForm.controls.address.dirty||e.tokenModelForm.controls.address.touched))("is-invalid",e.tokenModelForm.controls.address.invalid&&(e.tokenModelForm.controls.address.dirty||e.tokenModelForm.controls.address.touched)),a(4),M("is-valid",!e.tokenModelForm.controls.phone.invalid&&(e.tokenModelForm.controls.phone.dirty||e.tokenModelForm.controls.phone.touched))("is-invalid",e.tokenModelForm.controls.phone.invalid&&(e.tokenModelForm.controls.phone.dirty||e.tokenModelForm.controls.phone.touched)),a(2),m("disabled",e.tokenModelForm.invalid)}}function ue(n,o){if(n&1){let e=_();r(0,"div",11)(1,"h4",12),l(2,"Resolve query"),s(),r(3,"button",13),p("click",function(){let d=u(e).$implicit;return g(d.dismiss("Cross click"))}),s()(),b(4,me,5,0,"div",14)(5,pe,20,12,"div",14)}if(n&2){let e=c();a(4),m("ngIf",e.isModelLoading),a(),m("ngIf",!e.isModelLoading)}}var oe=(()=>{let o=class o{constructor(t,i){this.toastr=t,this.customerService=i,this.modalService=N(ee),this.isModelLoading=!1,this.tokenModelForm=new B({id:new f(0),queryType:new f(1,S.required),address:new f("",S.required),phone:new f("",S.required)}),this.pagination={totalCount:100,pagesize:10,pageNumber:1,data:[]},this.intervaObservable=w(2e3),this.reloadgridSubscriber=null}ngOnDestroy(){this.unsubscribeReloadgrid()}ngOnInit(){this.loadGrid()}unsubscribeReloadgrid(){this.reloadgridSubscriber&&this.reloadgridSubscriber.unsubscribe()}subscribeReloadGrid(){this.reloadgridSubscriber=this.intervaObservable.subscribe(t=>{this.loadGrid()})}loadGrid(){this.customerService.getUnResulvedTokenList(this.pagination.pageNumber,this.pagination.pagesize).subscribe({next:t=>{this.pagination=t,this.reloadgridSubscriber||this.subscribeReloadGrid()}})}onPagerChanged(t){this.pagination.pageNumber=t,this.loadGrid()}setTokenToProcess(t){this.customerService.processToken(t).subscribe({next:i=>{console.log(i),this.loadGrid()}})}setTokenToPending(t){this.customerService.pendingToken(t).subscribe({next:i=>{console.log(i),this.loadGrid()}})}resolveToken(t){this.unsubscribeReloadgrid(),this.isModelLoading=!0,this.modalService.open(this.resolveModel,{scrollable:!0}),this.customerService.getTokenById(t).subscribe({next:i=>{console.log(i),this.tokenModelForm.patchValue({id:i.id,address:i.address,phone:i.phone,queryType:i.queryId}),this.tokenModelForm.controls.queryType.disable(),this.isModelLoading=!1},error:i=>{this.isModelLoading=!0,this.toastr.error("Something went worng please try again later"),this.modalService.dismissAll()}})}submitTokenModel(){this.tokenModelForm.invalid||this.customerService.ResolveToken({id:this.tokenModelForm.controls.id.value,address:this.tokenModelForm.controls.address.value,phoneNumber:this.tokenModelForm.controls.phone.value,query:this.tokenModelForm.controls.queryType.value}).subscribe({next:t=>{this.toastr.success("Query is resolved"),this.tokenModelForm.reset(),this.modalService.dismissAll(),this.loadGrid()}})}getData(){return this.pagination.data}getAllQueryName(){return C.getAllQueryName()}getQueryName(t){return C.getQueryName(t)}getStatusName(t){return C.getStatusName(t)}getStatusclass(t){switch(t){case 2:return"table-warning";case 3:return"table-success"}return"table-primary"}};o.\u0275fac=function(i){return new(i||o)(k(A),k(D))},o.\u0275cmp=V({type:o,selectors:[["app-home"]],viewQuery:function(i,d){if(i&1&&H(se,5),i&2){let h;I(h=G())&&(d.resolveModel=h.first)}},decls:24,vars:2,consts:[[1,"container"],["role","main",1,"pb-3"],[1,"table","table-hover"],["scope","col"],[3,"class",4,"ngFor","ngForOf"],[3,"pagination","pageChanged"],["resolvModel",""],["scope","row"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-body"],[1,"text-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","exampleSelect1",1,"form-label","mt-4"],["formControlName","queryType",1,"form-select",3,"disabled"],[3,"ngValue",4,"ngFor","ngForOf"],["for","exampleInputEmail1",1,"form-label","mt-4"],["type","text","aria-describedby","emailHelp","placeholder","Address","formControlName","address",1,"form-control"],["type","text","aria-describedby","emailHelp","placeholder","Phone number","formControlName","phone",1,"form-control"],[1,"modal-footer"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"ngValue"]],template:function(i,d){i&1&&(r(0,"h3"),l(1,"Dash board"),s(),r(2,"div",0)(3,"main",1)(4,"table",2)(5,"thead")(6,"tr")(7,"th",3)(8,"strong"),l(9,"Id"),s()(),r(10,"th",3)(11,"strong"),l(12,"Query Type"),s()(),r(13,"th",3)(14,"strong"),l(15,"Query Status"),s()(),r(16,"th",3)(17,"strong"),l(18,"Action"),s()()()(),r(19,"tbody"),b(20,de,12,8,"tr",4),s()(),r(21,"app-pagination",5),p("pageChanged",function(re){return d.onPagerChanged(re)}),s()()(),b(22,ue,6,2,"ng-template",null,6,q)),i&2&&(a(20),m("ngForOf",d.getData()),a(),m("pagination",d.pagination))},dependencies:[R,P,L,U,X,Y,j,W,$,z,J,K]});let n=o;return n})();var ge=[{path:"",component:oe}],ne=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=y({type:o}),o.\u0275inj=v({imports:[F.forChild(ge),F]});let n=o;return n})();var Re=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=y({type:o}),o.\u0275inj=v({imports:[O,ne,te,Z]});let n=o;return n})();export{Re as EveluatorModule};
